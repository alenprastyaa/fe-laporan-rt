import{d as R,r as o,c as O,o as W,a as n,b as $,w as B,e,f as i,t as s,g as I,h as b,u as h,i as L,j as C,F as S,k as V,l as J,m as D,n as K,v as U,p as T}from"./index-DxklrK3W.js";import{a as p}from"./axios-2s9xPmg-.js";import{_ as Y}from"./AdminLayout-D1968QRW.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sweetalert2.esm.all-B3GDCxSY.js";const H={class:"mx-auto max-w-screen-2xl bg-gray-50 dark:bg-gray-900 min-h-screen"},q={key:0,class:"mb-6 p-4 bg-red-100 text-red-700 rounded-lg border border-red-200"},Q={class:"grid grid-cols-12 gap-4 md:gap-6 2xl:gap-7.5"},X={class:"col-span-12 xl:col-span-8 rounded-2xl border border-gray-200 bg-white px-5 pb-5 pt-5 dark:border-gray-800 dark:bg-gray-900 sm:px-6 sm:pt-6"},Z={class:"max-w-full overflow-x-auto custom-scrollbar"},ee={id:"chartOne",class:"-ml-4 min-w-[650px] xl:min-w-full pl-2"},te={class:"col-span-12 xl:col-span-4 rounded-2xl border border-gray-200 bg-white px-5 pt-5 pb-11 dark:border-gray-800 dark:bg-gray-900 sm:px-6 sm:pt-6"},ae={class:"mb-4"},se={class:"mt-1 text-gray-500 text-theme-sm dark:text-gray-400"},re={class:"relative max-h-[195px] mb-8"},oe={class:"h-full flex justify-center"},ne={class:"mx-auto mt-10 w-full max-w-[380px] text-center text-sm text-gray-500 sm:text-base mb-6"},le={class:"flex items-center justify-center gap-5 px-6 py-3.5 border-t border-gray-100 dark:border-gray-800"},de={class:"text-center"},ie={class:"text-base font-semibold text-gray-800 dark:text-white/90"},ce={class:"text-center"},ge={class:"text-base font-semibold text-red-500"},me={class:"col-span-12 xl:col-span-5 space-y-6"},ue={class:"rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-gray-900 sm:p-6"},pe={class:"mt-4 space-y-3"},xe={class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},ye={class:"text-sm font-bold text-gray-900 dark:text-white"},be={class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},he={class:"text-sm font-bold text-red-500"},_e={class:"rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-gray-900 sm:p-6"},fe={class:"flex items-center justify-between mb-4"},ke={class:"space-y-4"},ve={key:0,class:"text-center py-4 text-sm text-gray-500"},we={class:"flex items-center gap-3"},Be={class:"h-9 w-9 rounded-full bg-red-100 dark:bg-red-900/20 text-red-600 flex items-center justify-center font-bold text-xs"},Ie={class:"text-sm font-semibold text-gray-800 dark:text-white"},Ce={class:"text-xs text-gray-500"},Se=["onClick"],De={class:"col-span-12 xl:col-span-7 rounded-2xl border border-gray-200 bg-white px-4 pb-3 pt-4 dark:border-gray-800 dark:bg-gray-900 sm:px-6"},Te={class:"max-w-full overflow-x-auto"},Ae={class:"min-w-full"},Pe={class:"py-4 px-2 md:py-3"},Fe={class:"flex items-center gap-3"},je={key:0},Ee={key:1},Ne={class:"text-sm font-medium text-gray-800 dark:text-white truncate"},ze={class:"py-4 px-2 md:py-3"},Me={class:"py-4 px-2 md:py-3 text-sm text-gray-600 dark:text-gray-300"},Re={class:"py-4 px-2 md:py-3 text-sm text-gray-500 dark:text-gray-400"},Oe=R({__name:"Ecommerce",setup(We){const A=localStorage.getItem("role"),P=V(),_=o(!1),u=o(""),l=o({total_warga:0,saldo_akhir:0,pemasukan_all_time:0,pengeluaran_all_time:0,warga_menunggak:0}),f=o([]),x=o([]),y=o(0),k=o([{name:"Pemasukan",data:[]},{name:"Pengeluaran",data:[]}]),v=O(()=>{const r=l.value.total_warga*1e4;if(r===0)return[0];const t=y.value/r*100;return[Math.min(parseFloat(t.toFixed(1)),100)]}),F=o({legend:{show:!0,position:"top",horizontalAlign:"left"},colors:["#3C50E0","#80CAEE"],chart:{fontFamily:"Satoshi, sans-serif",height:335,type:"area",toolbar:{show:!1}},fill:{gradient:{opacityFrom:.55,opacityTo:0}},stroke:{curve:"smooth",width:2},grid:{strokeDashArray:5,xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}}},dataLabels:{enabled:!1},xaxis:{type:"category",categories:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],axisBorder:{show:!1},axisTicks:{show:!1}}}),j=o({colors:["#3C50E0"],chart:{fontFamily:"Satoshi, sans-serif",type:"radialBar",height:335},plotOptions:{radialBar:{startAngle:-90,endAngle:90,hollow:{size:"70%"},track:{background:"#E2E8F0",strokeWidth:"97%"},dataLabels:{name:{show:!1},value:{offsetY:-5,fontSize:"36px",fontWeight:"600",color:"#1C2434"}}}},fill:{type:"solid"},stroke:{lineCap:"round"},labels:["Progress"]}),g=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r),E=r=>{const t=new Intl.DateTimeFormat("id-ID",{month:"long"}).format(new Date),c=`Halo Bapak/Ibu ${r.username}, mengingatkan untuk pembayaran iuran kas RT bulan ${t}. Terima kasih.`,a=r.phone.startsWith("0")?"62"+r.phone.slice(1):r.phone;window.open(`https://wa.me/${a}?text=${encodeURIComponent(c)}`,"_blank")},N=async()=>{var r;_.value=!0,u.value="";try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const c={headers:{Authorization:`Bearer ${t}`}},a=new Date().getMonth(),m={bulan:a+1,tahun:new Date().getFullYear(),limit:5},[w,z,M]=await Promise.all([p.get("https://alentest.my.id/laporan/api/dashboard/stats",c),p.get("https://alentest.my.id/laporan/api/dashboard/recent",c),p.get("https://alentest.my.id/laporan/api/kas/masuk/belum-bayar",{...c,params:m})]),d=w.data;l.value={total_warga:d.cards.total_warga,saldo_akhir:d.cards.saldo_akhir,pemasukan_all_time:d.cards.pemasukan_all_time,pengeluaran_all_time:d.cards.pengeluaran_all_time,warga_menunggak:d.cards.warga_menunggak_bulan_ini},k.value=[{name:"Pemasukan",data:d.chart.pemasukan},{name:"Pengeluaran",data:d.chart.pengeluaran}],y.value=d.chart.pemasukan[a]||0,f.value=z.data,x.value=M.data.data}catch(t){console.error("Error fetching data:",t),u.value="Gagal mengambil data dashboard.",p.isAxiosError(t)&&((r=t.response)==null?void 0:r.status)===401&&localStorage.removeItem("token"),P.push("/signin")}finally{_.value=!1}};return W(()=>{N()}),(r,t)=>{const c=J("router-link");return n(),$(Y,null,{default:B(()=>[e("div",H,[t[13]||(t[13]=e("div",{class:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},null,-1)),u.value?(n(),i("div",q,s(u.value),1)):I("",!0),e("div",Q,[e("div",X,[t[0]||(t[0]=e("div",{class:"flex flex-col gap-5 mb-6 sm:flex-row sm:justify-between"},[e("div",{class:"w-full"},[e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"},"Statistik Keuangan"),e("p",{class:"mt-1 text-gray-500 text-theme-sm dark:text-gray-400"},"Pemasukan vs Pengeluaran Tahun Ini")])],-1)),e("div",Z,[e("div",ee,[b(h(D),{type:"area",height:"310",options:F.value,series:k.value},null,8,["options","series"])])])]),e("div",te,[e("div",ae,[t[1]||(t[1]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"},"Target Iuran Bulan Ini",-1)),e("p",se," Target: "+s(g(l.value.total_warga*1e4))+" ("+s(l.value.total_warga)+" Warga) ",1)]),e("div",re,[e("div",oe,[b(h(D),{type:"radialBar",height:"330",options:j.value,series:v.value},null,8,["options","series"])])]),e("p",ne," Pemasukan bulan ini mencapai "+s(g(y.value))+". "+s(v.value[0]>=100?"Target bulan ini telah tercapai!":"Ayo kumpulkan iuran tepat waktu!"),1),e("div",le,[e("div",de,[t[2]||(t[2]=e("p",{class:"mb-1 text-gray-500 text-xs dark:text-gray-400"},"Total Pemasukan",-1)),e("p",ie,s(g(l.value.pemasukan_all_time)),1)]),t[4]||(t[4]=e("div",{class:"w-px bg-gray-200 h-8 dark:bg-gray-700"},null,-1)),e("div",ce,[t[3]||(t[3]=e("p",{class:"mb-1 text-gray-500 text-xs dark:text-gray-400"},"Total Pengeluaran",-1)),e("p",ge,s(g(l.value.pengeluaran_all_time)),1)])])]),e("div",me,[e("div",ue,[t[7]||(t[7]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90 mb-4"},"Sebaran Warga",-1)),e("div",pe,[e("div",xe,[t[5]||(t[5]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-2 h-2 rounded-full bg-blue-600"}),e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Total Warga")],-1)),e("span",ye,s(l.value.total_warga)+" Orang",1)]),e("div",be,[t[6]||(t[6]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-2 h-2 rounded-full bg-red-500"}),e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Menunggak Bulan Ini")],-1)),e("span",he,s(l.value.warga_menunggak)+" Orang",1)])])]),e("div",_e,[e("div",fe,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"},"Belum Bayar (Bulan Ini)",-1)),b(c,{to:"/laporan-kas",class:"text-xs text-blue-600 hover:underline"},{default:B(()=>t[8]||(t[8]=[L("Lihat Semua")])),_:1})]),e("div",ke,[x.value.length===0?(n(),i("div",ve,"Semua warga sudah bayar ✨")):I("",!0),(n(!0),i(S,null,C(x.value,(a,m)=>(n(),i("div",{key:m,class:"flex items-center justify-between p-3 border border-gray-50 dark:border-gray-800 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800/50 transition"},[e("div",we,[e("div",Be,s(a.username.charAt(0).toUpperCase()),1),e("div",null,[e("p",Ie,s(a.username),1),e("p",Ce,s(a.phone||"No Phone"),1)])]),K(e("button",{onClick:w=>E(a),class:"p-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors"},t[10]||(t[10]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.246 2.248 3.484 5.232 3.484 8.412-.003 6.557-5.338 11.892-11.893 11.892-1.997-.001-3.951-.5-5.688-1.448l-6.309 1.656zm6.29-4.464c1.56.925 3.278 1.411 5.037 1.413 5.564 0 10.091-4.527 10.093-10.093 0-2.696-1.05-5.231-2.956-7.138-1.907-1.907-4.442-2.956-7.137-2.956-5.566 0-10.093 4.527-10.093 10.094 0 1.896.536 3.717 1.548 5.301l-.95 3.468 3.558-.934zm11.333-7.391c-.302-.151-1.785-.881-2.062-.982-.277-.1-.478-.151-.68.151-.202.302-.782.982-.957 1.183-.176.202-.352.226-.654.076-.302-.151-1.274-.47-2.426-1.5-.897-.8-1.502-1.79-1.678-2.091-.176-.302-.019-.465.131-.614.136-.134.302-.352.453-.528.151-.176.202-.302.302-.503.1-.202.05-.377-.025-.528-.076-.151-.68-1.641-.932-2.244-.247-.587-.499-.508-.68-.517-.176-.008-.377-.01-.579-.01-.202 0-.528.076-.805.377-.277.302-1.057 1.031-1.057 2.515 0 1.485 1.082 2.92 1.232 3.121.151.202 2.13 3.253 5.159 4.561.72.311 1.282.496 1.719.635.722.23 1.38.197 1.9.12.58-.086 1.785-.73 2.037-1.435.252-.704.252-1.308.176-1.435-.076-.127-.277-.202-.579-.353z"})],-1)]),8,Se),[[U,h(A)=="admin"]])]))),128))])])]),e("div",De,[t[12]||(t[12]=e("div",{class:"flex items-center justify-between mb-4"},[e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"},"Aktivitas Terbaru")],-1)),e("div",Te,[e("table",Ae,[t[11]||(t[11]=e("thead",null,[e("tr",{class:"border-b border-gray-100 dark:border-gray-800"},[e("th",{class:"py-3 text-left font-medium text-gray-500 text-sm"},"Keterangan"),e("th",{class:"py-3 text-left font-medium text-gray-500 text-sm"},"Tipe"),e("th",{class:"py-3 text-left font-medium text-gray-500 text-sm"},"Nominal"),e("th",{class:"py-3 text-left font-medium text-gray-500 text-sm"},"Tanggal")])],-1)),e("tbody",null,[(n(!0),i(S,null,C(f.value,(a,m)=>(n(),i("tr",{key:m,class:"border-b border-gray-50 dark:border-gray-800 last:border-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors"},[e("td",Pe,[e("div",Fe,[e("div",{class:T(["h-10 w-10 rounded-full flex items-center justify-center flex-shrink-0",a.type==="masuk"?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},[a.type==="masuk"?(n(),i("span",je,"↓")):(n(),i("span",Ee,"↑"))],2),e("span",Ne,s(a.description),1)])]),e("td",ze,[e("span",{class:T(["text-xs font-medium px-3 py-1.5 rounded-full inline-block",a.type==="masuk"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"])},s(a.type==="masuk"?"Pemasukan":"Pengeluaran"),3)]),e("td",Me,s(g(a.amount)),1),e("td",Re,s(new Date(a.date).toLocaleDateString("id-ID")),1)]))),128))])])])])])])]),_:1})}}}),Ue=G(Oe,[["__scopeId","data-v-0db2bd81"]]);export{Ue as default};
