import{r as n,q as M,o as H,b as z,w as A,a as i,e,s as u,v as x,B as T,i as I,f as g,j as L,F as E,t as l,E as N,g as q,n as R}from"./index-CglahB4C.js";import{a as b}from"./axios-2s9xPmg-.js";import{S as p}from"./sweetalert2.esm.all-B3GDCxSY.js";import{_ as F}from"./AdminLayout-CQK_wFUU.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"space-y-4"},Y={class:"flex flex-col sm:flex-row gap-4 justify-between items-center bg-white dark:bg-gray-900 p-4 rounded-xl border border-gray-200 dark:border-gray-800"},Q={class:"relative w-full sm:w-64"},J={class:"flex items-center gap-3 w-full sm:w-auto"},O={class:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]"},W={class:"max-w-full overflow-x-auto custom-scrollbar"},X={class:"min-w-full"},Z={class:"divide-y divide-gray-200 dark:divide-gray-700"},ee={key:0},te={key:1},ae={class:"px-5 py-4 sm:px-6"},re={class:"flex items-center gap-3"},se={class:"w-10 h-10 rounded-full overflow-hidden bg-gray-200"},oe=["src"],le={class:"block font-medium text-gray-800 dark:text-white/90 text-sm"},ne={class:"px-5 py-4 sm:px-6 text-sm text-gray-600 dark:text-gray-400"},de={class:"px-5 py-4 sm:px-6"},ie={class:"px-5 py-4 sm:px-6 text-sm text-gray-500"},ue={class:"px-5 py-4 sm:px-6 text-right"},pe={class:"flex items-center justify-end gap-2"},ce=["onClick"],ge=["onClick"],me={class:"border-t border-gray-200 dark:border-gray-700 px-5 py-4 flex items-center justify-between"},xe={class:"text-sm text-gray-500"},be={class:"flex gap-2"},ye=["disabled"],fe=["disabled"],he={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 backdrop-blur-sm"},ke={class:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-md shadow-2xl overflow-hidden animate-fade-in-up"},ve={class:"px-6 py-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center"},we={class:"text-lg font-bold text-gray-800 dark:text-white"},_e={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Be=["required"],Ce={class:"pt-2 flex gap-3"},Pe={type:"submit",class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium shadow-lg shadow-blue-500/30"},Ue={__name:"BasicTables",setup(Me){const y=n([]),f=n(!1),h=n(""),k=n("");let v=null;const o=M({currentPage:1,limit:8,totalData:0,totalPage:1}),w=n(!1),c=n(!1),_=n(!1),C=n(null),r=M({username:"",phone:"",role:"user",password:""}),d=async()=>{f.value=!0;try{const s=localStorage.getItem("token"),t=await b.get("https://alentest.my.id/laporan/api/auth/users",{headers:{Authorization:`Bearer ${s}`},params:{page:o.currentPage,limit:o.limit,search:h.value,role:k.value}});t.data.status==="success"&&(y.value=t.data.data,o.currentPage=t.data.pagination.currentPage,o.totalPage=t.data.pagination.totalPage)}catch(s){console.error(s)}finally{f.value=!1}},j=async()=>{var a,m;_.value=!0;const t={Authorization:`Bearer ${localStorage.getItem("token")}`};try{c.value?(await b.put(`https://alentest.my.id/laporan/api/auth/users/${C.value}`,r,{headers:t}),p.fire("Berhasil","Data user diperbarui","success")):(await b.post("https://alentest.my.id/laporan/api/auth/users",r,{headers:t}),p.fire("Berhasil","User baru ditambahkan","success")),B(),d()}catch(D){p.fire("Gagal",((m=(a=D.response)==null?void 0:a.data)==null?void 0:m.message)||"Terjadi kesalahan","error")}finally{_.value=!1}},S=async s=>{if((await p.fire({title:"Yakin hapus user ini?",text:"Data tidak bisa dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{const a=localStorage.getItem("token");await b.delete(`https://alentest.my.id/laporan/api/auth/users/${s}`,{headers:{Authorization:`Bearer ${a}`}}),p.fire("Terhapus!","User telah dihapus.","success"),d()}catch{p.fire("Gagal","Gagal menghapus data","error")}},$=()=>{v&&clearTimeout(v),v=setTimeout(()=>{o.currentPage=1,d()},500)},P=s=>{o.currentPage=s,d()},V=s=>s?new Date(s).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"-",U=(s,t=null)=>{c.value=s==="edit",w.value=!0,s==="edit"&&t?(C.value=t.id,r.username=t.username,r.phone=t.phone,r.role=t.role,r.password=""):(r.username="",r.phone="",r.role="user",r.password="")},B=()=>{w.value=!1};return H(d),(s,t)=>(i(),z(F,null,{default:A(()=>[e("div",K,[e("div",Y,[e("div",Q,[t[9]||(t[9]=e("span",{class:"absolute inset-y-0 left-0 flex items-center pl-3"},[e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>h.value=a),onInput:$,type:"text",placeholder:"Cari Username / HP...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white"},null,544),[[x,h.value]])]),e("div",J,[u(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>k.value=a),onChange:d,class:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white"},t[10]||(t[10]=[e("option",{value:""},"Semua Role",-1),e("option",{value:"admin"},"Admin",-1),e("option",{value:"user"},"User",-1)]),544),[[T,k.value]]),e("button",{onClick:t[2]||(t[2]=a=>U("add")),class:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors text-sm font-medium"},t[11]||(t[11]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),I(" Tambah User ")]))])]),e("div",O,[e("div",W,[e("table",X,[t[16]||(t[16]=e("thead",null,[e("tr",{class:"border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50"},[e("th",{class:"px-5 py-3 text-left sm:px-6 font-medium text-gray-500 text-xs uppercase"},"User"),e("th",{class:"px-5 py-3 text-left sm:px-6 font-medium text-gray-500 text-xs uppercase"},"Kontak"),e("th",{class:"px-5 py-3 text-left sm:px-6 font-medium text-gray-500 text-xs uppercase"},"Role"),e("th",{class:"px-5 py-3 text-left sm:px-6 font-medium text-gray-500 text-xs uppercase"},"Bergabung"),e("th",{class:"px-5 py-3 text-right sm:px-6 font-medium text-gray-500 text-xs uppercase"},"Aksi")])],-1)),e("tbody",Z,[f.value?(i(),g("tr",ee,t[12]||(t[12]=[e("td",{colspan:"5",class:"px-5 py-8 text-center text-gray-500"},"Memuat data...",-1)]))):y.value.length===0?(i(),g("tr",te,t[13]||(t[13]=[e("td",{colspan:"5",class:"px-5 py-8 text-center text-gray-500"},"Tidak ada data ditemukan.",-1)]))):(i(!0),g(E,{key:2},L(y.value,a=>(i(),g("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-white/[0.02] transition-colors"},[e("td",ae,[e("div",re,[e("div",se,[e("img",{src:`https://ui-avatars.com/api/?name=${a.username}&background=random`,alt:"Avatar"},null,8,oe)]),e("div",null,[e("span",le,l(a.username),1)])])]),e("td",ne,l(a.phone||"-"),1),e("td",de,[e("span",{class:R(["rounded-full px-2 py-1 text-xs font-medium capitalize",a.role==="admin"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"])},l(a.role),3)]),e("td",ie,l(V(a.created_at)),1),e("td",ue,[e("div",pe,[e("button",{onClick:m=>U("edit",a),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"Edit"},t[14]||(t[14]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,ce),e("button",{onClick:m=>S(a.id),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Hapus"},t[15]||(t[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,ge)])])]))),128))])])]),e("div",me,[e("span",xe,"Hal "+l(o.currentPage)+" dari "+l(o.totalPage),1),e("div",be,[e("button",{onClick:t[3]||(t[3]=a=>P(o.currentPage-1)),disabled:o.currentPage<=1,class:"px-3 py-1 text-sm border rounded hover:bg-gray-100 disabled:opacity-50 dark:text-white dark:hover:bg-blue-400"},"Prev",8,ye),e("button",{onClick:t[4]||(t[4]=a=>P(o.currentPage+1)),disabled:o.currentPage>=o.totalPage,class:"px-3 py-1 text-sm border rounded hover:bg-gray-100 disabled:opacity-50 dark:text-white dark:hover:bg-blue-400"},"Next",8,fe)])])]),w.value?(i(),g("div",he,[e("div",ke,[e("div",ve,[e("h3",we,l(c.value?"Edit User":"Tambah User Baru"),1),e("button",{onClick:B,class:"text-gray-400 hover:text-gray-600"},t[17]||(t[17]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("form",{onSubmit:N(j,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Username",-1)),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>r.username=a),type:"text",class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-600 dark:text-white",required:""},null,512),[[x,r.username]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Nomor HP",-1)),u(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>r.phone=a),type:"text",class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-600 dark:text-white"},null,512),[[x,r.phone]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Role",-1)),u(e("select",{"onUpdate:modelValue":t[7]||(t[7]=a=>r.role=a),class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-600 dark:text-white"},t[20]||(t[20]=[e("option",{value:"user"},"User",-1),e("option",{value:"admin"},"Admin",-1)]),512),[[T,r.role]])]),e("div",null,[e("label",_e," Password "+l(c.value?"(Kosongkan jika tidak diubah)":""),1),u(e("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>r.password=a),type:"password",class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-600 dark:text-white",required:!c.value},null,8,Be),[[x,r.password]])]),e("div",Ce,[e("button",{type:"button",onClick:B,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium"},"Batal"),e("button",Pe,l(_.value?"Menyimpan...":"Simpan"),1)])],32)])])):q("",!0)])]),_:1}))}},De=G(Ue,[["__scopeId","data-v-39f8490e"]]);export{De as default};
