import{r as n,s as M,o as D,b as H,w as V,a as i,e,n as p,x,i as z,f as g,j as A,F as L,t as l,G as N,C as R,g as E,p as G}from"./index-DxklrK3W.js";import{a as b}from"./axios-2s9xPmg-.js";import{S as d}from"./sweetalert2.esm.all-B3GDCxSY.js";import{_ as q}from"./AdminLayout-D1968QRW.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"space-y-4"},Y={class:"flex flex-col sm:flex-row gap-4 justify-between items-center bg-white dark:bg-gray-900 p-4 rounded-xl border border-gray-200 dark:border-gray-800"},Q={class:"relative w-full sm:w-64"},J={class:"flex items-center gap-3 w-full sm:w-auto"},O={class:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]"},W={class:"max-w-full overflow-x-auto custom-scrollbar"},X={class:"min-w-full"},Z={class:"divide-y divide-gray-200 dark:divide-gray-700"},ee={key:0},te={key:1},re={class:"px-5 py-4 sm:px-6"},ae={class:"flex items-center gap-3"},se={class:"w-10 h-10 rounded-full overflow-hidden bg-gray-200"},oe=["src"],le={class:"block font-medium text-gray-800 dark:text-white/90 text-sm"},ne={class:"px-5 py-4 sm:px-6 text-sm text-gray-600 dark:text-gray-400"},ie={class:"px-5 py-4 sm:px-6"},de={class:"px-5 py-4 sm:px-6 text-sm text-gray-500"},ue={class:"px-5 py-4 sm:px-6 text-right"},ce={class:"flex items-center justify-end gap-2"},pe=["onClick"],ge=["onClick"],me={class:"border-t border-gray-200 dark:border-gray-700 px-5 py-4 flex items-center justify-between"},xe={class:"text-sm text-gray-500"},be={class:"flex gap-2"},ye=["disabled"],fe=["disabled"],he={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 backdrop-blur-sm"},ke={class:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-md shadow-2xl overflow-hidden animate-fade-in-up"},ve={class:"px-6 py-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center"},we={class:"text-lg font-bold text-gray-800 dark:text-white"},_e={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Be=["required"],Ce={class:"pt-2 flex gap-3"},Pe={type:"submit",class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium shadow-lg shadow-blue-500/30"},Me={__name:"BasicTables",setup(Se){const y=n([]),f=n(!1),h=n(""),S=n("");let k=null;const s=M({currentPage:1,limit:8,totalData:0,totalPage:1}),v=n(!1),u=n(!1),w=n(!1),B=n(null),a=M({username:"",phone:"",role:"user",password:"",rt:""}),c=async()=>{f.value=!0;const o=localStorage.getItem("rt");try{const t=localStorage.getItem("token"),r=await b.get("https://alentest.my.id/laporan/api/auth/users",{headers:{Authorization:`Bearer ${t}`},params:{page:s.currentPage,limit:s.limit,search:h.value,role:S.value,rt:o}});r.data.status==="success"&&(y.value=r.data.data,s.currentPage=r.data.pagination.currentPage,s.totalPage=r.data.pagination.totalPage)}catch(t){console.error(t)}finally{f.value=!1}},U=async()=>{var r,m;w.value=!0;const t={Authorization:`Bearer ${localStorage.getItem("token")}`};a.rt||(a.rt=localStorage.getItem("rt"));try{u.value?(await b.put(`https://alentest.my.id/laporan/api/auth/users/${B.value}`,a,{headers:t}),d.fire("Berhasil","Data user diperbarui","success")):(await b.post("https://alentest.my.id/laporan/api/auth/users",a,{headers:t}),d.fire("Berhasil","User baru ditambahkan","success")),_(),c()}catch(I){d.fire("Gagal",((m=(r=I.response)==null?void 0:r.data)==null?void 0:m.message)||"Terjadi kesalahan","error")}finally{w.value=!1}},T=async o=>{if((await d.fire({title:"Yakin hapus user ini?",text:"Data tidak bisa dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{const r=localStorage.getItem("token");await b.delete(`https://alentest.my.id/laporan/api/auth/users/${o}`,{headers:{Authorization:`Bearer ${r}`}}),d.fire("Terhapus!","User telah dihapus.","success"),c()}catch{d.fire("Gagal","Gagal menghapus data","error")}},j=()=>{k&&clearTimeout(k),k=setTimeout(()=>{s.currentPage=1,c()},500)},C=o=>{s.currentPage=o,c()},$=o=>o?new Date(o).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"-",P=(o,t=null)=>{u.value=o==="edit",v.value=!0;const r=localStorage.getItem("rt")||"";o==="edit"&&t?(B.value=t.id,a.username=t.username,a.phone=t.phone,a.role=t.role,a.rt=t.rt||r,a.password=""):(a.username="",a.phone="",a.role="user",a.password="",a.rt=r)},_=()=>{v.value=!1};return D(c),(o,t)=>(i(),H(q,null,{default:V(()=>[e("div",K,[e("div",Y,[e("div",Q,[t[8]||(t[8]=e("span",{class:"absolute inset-y-0 left-0 flex items-center pl-3"},[e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>h.value=r),onInput:j,type:"text",placeholder:"Cari Username / HP...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white"},null,544),[[x,h.value]])]),e("div",J,[e("button",{onClick:t[1]||(t[1]=r=>P("add")),class:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors text-sm font-medium"},t[9]||(t[9]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),z(" Tambah User ")]))])]),e("div",O,[e("div",W,[e("table",X,[t[14]||(t[14]=e("thead",null,[e("tr",{class:"border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50"},[e("th",{class:"px-5 py-3 text-left sm:px-6 font-medium text-gray-500 text-xs uppercase"},"User"),e("th",{class:"px-5 py-3 text-left sm:px-6 font-medium text-gray-500 text-xs uppercase"},"Kontak"),e("th",{class:"px-5 py-3 text-left sm:px-6 font-medium text-gray-500 text-xs uppercase"},"Role"),e("th",{class:"px-5 py-3 text-left sm:px-6 font-medium text-gray-500 text-xs uppercase"},"Bergabung"),e("th",{class:"px-5 py-3 text-right sm:px-6 font-medium text-gray-500 text-xs uppercase"},"Aksi")])],-1)),e("tbody",Z,[f.value?(i(),g("tr",ee,t[10]||(t[10]=[e("td",{colspan:"5",class:"px-5 py-8 text-center text-gray-500"},"Memuat data...",-1)]))):y.value.length===0?(i(),g("tr",te,t[11]||(t[11]=[e("td",{colspan:"5",class:"px-5 py-8 text-center text-gray-500"},"Tidak ada data ditemukan.",-1)]))):(i(!0),g(L,{key:2},A(y.value,r=>(i(),g("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-white/[0.02] transition-colors"},[e("td",re,[e("div",ae,[e("div",se,[e("img",{src:`https://ui-avatars.com/api/?name=${r.username}&background=random`,alt:"Avatar"},null,8,oe)]),e("div",null,[e("span",le,l(r.username),1)])])]),e("td",ne,l(r.phone||"-"),1),e("td",ie,[e("span",{class:G(["rounded-full px-2 py-1 text-xs font-medium capitalize",r.role==="admin"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"])},l(r.role),3)]),e("td",de,l($(r.created_at)),1),e("td",ue,[e("div",ce,[e("button",{onClick:m=>P("edit",r),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"Edit"},t[12]||(t[12]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,pe),e("button",{onClick:m=>T(r.id),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Hapus"},t[13]||(t[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,ge)])])]))),128))])])]),e("div",me,[e("span",xe,"Hal "+l(s.currentPage)+" dari "+l(s.totalPage),1),e("div",be,[e("button",{onClick:t[2]||(t[2]=r=>C(s.currentPage-1)),disabled:s.currentPage<=1,class:"px-3 py-1 text-sm border rounded hover:bg-gray-100 disabled:opacity-50 dark:text-white dark:hover:bg-blue-400"},"Prev",8,ye),e("button",{onClick:t[3]||(t[3]=r=>C(s.currentPage+1)),disabled:s.currentPage>=s.totalPage,class:"px-3 py-1 text-sm border rounded hover:bg-gray-100 disabled:opacity-50 dark:text-white dark:hover:bg-blue-400"},"Next",8,fe)])])]),v.value?(i(),g("div",he,[e("div",ke,[e("div",ve,[e("h3",we,l(u.value?"Edit User":"Tambah User Baru"),1),e("button",{onClick:_,class:"text-gray-400 hover:text-gray-600"},t[15]||(t[15]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("form",{onSubmit:N(U,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Username",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>a.username=r),type:"text",class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-600 dark:text-white",required:""},null,512),[[x,a.username]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Nomor HP",-1)),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>a.phone=r),type:"text",class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-600 dark:text-white"},null,512),[[x,a.phone]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Role",-1)),p(e("select",{"onUpdate:modelValue":t[6]||(t[6]=r=>a.role=r),class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-600 dark:text-white"},t[18]||(t[18]=[e("option",{value:"user"},"warga",-1)]),512),[[R,a.role]])]),e("div",null,[e("label",_e," Password "+l(u.value?"(Kosongkan jika tidak diubah)":""),1),p(e("input",{"onUpdate:modelValue":t[7]||(t[7]=r=>a.password=r),type:"password",class:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-600 dark:text-white",required:!u.value},null,8,Be),[[x,a.password]])]),e("div",Ce,[e("button",{type:"button",onClick:_,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium dark:text-white dark:hover:text-black"},"Batal"),e("button",Pe,l(w.value?"Menyimpan...":"Simpan"),1)])],32)])])):E("",!0)])]),_:1}))}},De=F(Me,[["__scopeId","data-v-bc25a725"]]);export{De as default};
