import{d as W,r as i,c as C,o as $,a as d,b as K,w as S,e,f as u,t as s,g as I,h,u as b,i as y,n as V,j as D,F as j,k as J,l as Y,m as T,p as G,v as U,q as A}from"./index-CqU-N3Nx.js";import{a as c}from"./axios-2s9xPmg-.js";import{_ as q}from"./AdminLayout-wSIyYV-Y.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sweetalert2.esm.all-B3GDCxSY.js";const Q={class:"mx-auto max-w-screen-2xl bg-gray-50 dark:bg-gray-900 min-h-screen"},X={key:0,class:"mb-6 p-4 bg-red-100 text-red-700 rounded-lg border border-red-200"},Z={class:"grid grid-cols-12 gap-4 md:gap-6 2xl:gap-7.5"},ee={class:"col-span-12 xl:col-span-8 rounded-2xl border border-gray-200 bg-white px-5 pb-5 pt-5 dark:border-gray-800 dark:bg-gray-900 sm:px-6 sm:pt-6"},te={class:"max-w-full overflow-x-auto custom-scrollbar"},ae={id:"chartOne",class:"-ml-4 min-w-[650px] xl:min-w-full pl-2"},se={class:"col-span-12 xl:col-span-4 rounded-2xl border border-gray-200 bg-white px-5 pt-5 pb-11 dark:border-gray-800 dark:bg-gray-900 sm:px-6 sm:pt-6"},re={class:"mb-4"},ne={class:"mt-1 text-gray-500 text-theme-sm dark:text-gray-400"},oe={class:"relative max-h-[195px] mb-8"},le={class:"h-full flex justify-center"},ie={class:"mx-auto mt-10 w-full max-w-[380px] text-center text-sm text-gray-500 sm:text-base mb-6"},de={class:"font-bold text-gray-800 dark:text-white"},ue={class:"font-bold text-red-500"},ge={class:"grid grid-cols-2 gap-4 border-t border-gray-100 dark:border-gray-800 pt-4"},me={class:"text-center p-2 rounded-lg bg-blue-50 dark:bg-blue-900/20"},ce={class:"text-sm font-bold text-gray-800 dark:text-white/90"},pe={class:"text-center p-2 rounded-lg bg-green-50 dark:bg-green-900/20"},xe={class:"text-sm font-bold text-gray-800 dark:text-white/90"},he={class:"col-span-12 xl:col-span-5 space-y-6"},be={class:"rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-gray-900 sm:p-6"},ye={class:"mt-4 space-y-3"},_e={class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 mb-4"},fe={class:"flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg"},ke={class:"text-sm font-bold text-green-600"},ve={class:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/20 rounded-lg"},we={class:"text-sm font-bold text-red-500"},Be={class:"rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-gray-900 sm:p-6"},Ce={class:"flex items-center justify-between mb-4"},Se={class:"space-y-4 max-h-[300px] overflow-y-auto custom-scrollbar pr-1"},Ie={key:0,class:"text-center py-4 text-sm text-gray-500"},De={class:"flex items-center gap-3"},je={class:"h-9 w-9 rounded-full bg-red-100 dark:bg-red-900/20 text-red-600 flex items-center justify-center font-bold text-xs shrink-0"},Te={class:"min-w-0"},Ae={class:"text-sm font-semibold text-gray-800 dark:text-white truncate"},ze={class:"text-xs text-gray-500 truncate"},Fe=["onClick"],Pe={class:"col-span-12 xl:col-span-7 rounded-2xl border border-gray-200 bg-white px-4 pb-3 pt-4 dark:border-gray-800 dark:bg-gray-900 sm:px-6"},Ee={class:"max-w-full overflow-x-auto"},Me={class:"min-w-full"},Ne={class:"py-4 px-2 md:py-3"},Re={class:"flex items-center gap-3"},Le={key:0},Oe={key:1},We={class:"text-sm font-medium text-gray-800 dark:text-white truncate max-w-[150px] sm:max-w-xs"},$e={class:"py-4 px-2 md:py-3"},Ke={class:"py-4 px-2 md:py-3 text-sm text-gray-600 dark:text-gray-300"},Ve={class:"py-4 px-2 md:py-3 text-sm text-gray-500 dark:text-gray-400"},Je=W({__name:"Ecommerce",setup(Ye){const z=localStorage.getItem("role"),F=J(),_=i(!1),m=i(""),n=i({total_warga:0,saldo_akhir:0,pemasukan_all_time:0,pengeluaran_all_time:0,warga_menunggak:0,pemasukan_wajib_tahun_ini:0,pemasukan_sukarela_tahun_ini:0}),f=i([]),p=i([]),P=i(0),k=i([{name:"Pemasukan",data:[]},{name:"Pengeluaran",data:[]}]),v=C(()=>Math.max(0,n.value.total_warga-n.value.warga_menunggak)),w=C(()=>{const r=n.value.total_warga;if(r===0)return[0];const l=(r-n.value.warga_menunggak)/r*100;return[Math.min(parseFloat(l.toFixed(1)),100)]}),E=i({legend:{show:!0,position:"top",horizontalAlign:"left"},colors:["#3C50E0","#80CAEE"],chart:{fontFamily:"Satoshi, sans-serif",height:335,type:"area",toolbar:{show:!1}},fill:{gradient:{opacityFrom:.55,opacityTo:0}},stroke:{curve:"smooth",width:2},grid:{strokeDashArray:5,xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}}},dataLabels:{enabled:!1},xaxis:{type:"category",categories:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],axisBorder:{show:!1},axisTicks:{show:!1}}}),M=i({colors:["#10B981"],chart:{fontFamily:"Satoshi, sans-serif",type:"radialBar",height:335},plotOptions:{radialBar:{startAngle:-90,endAngle:90,hollow:{size:"60%"},track:{background:"#E2E8F0",strokeWidth:"97%"},dataLabels:{name:{show:!0,label:"Lunas",color:"#64748B",offsetY:20},value:{offsetY:-20,fontSize:"30px",fontWeight:"600",color:"#1C2434"}}}},fill:{type:"solid"},stroke:{lineCap:"round"},labels:["Lunas"]}),x=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r),N=r=>{const t=new Intl.DateTimeFormat("id-ID",{month:"long"}).format(new Date),l=`Halo Bapak/Ibu ${r.username}, mengingatkan untuk pembayaran iuran kas RT bulan ${t}. Terima kasih.`,a=r.phone.startsWith("0")?"62"+r.phone.slice(1):r.phone;window.open(`https://wa.me/${a}?text=${encodeURIComponent(l)}`,"_blank")},R=async()=>{var r;_.value=!0,m.value="";try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const l={headers:{Authorization:`Bearer ${t}`}},a=new Date().getMonth(),g={bulan:a+1,tahun:new Date().getFullYear()},[B,L,O]=await Promise.all([c.get("https://alentest.my.id/laporan/api/dashboard/stats",l),c.get("https://alentest.my.id/laporan/api/dashboard/recent",l),c.get("https://alentest.my.id/laporan/api/kas/masuk/belum-bayar",{...l,params:g})]),o=B.data;n.value={total_warga:o.cards.total_warga,saldo_akhir:o.cards.saldo_akhir,pemasukan_all_time:o.cards.pemasukan_all_time,pengeluaran_all_time:o.cards.pengeluaran_all_time,warga_menunggak:o.cards.warga_menunggak_bulan_ini,pemasukan_wajib_tahun_ini:o.cards.pemasukan_wajib_tahun_ini,pemasukan_sukarela_tahun_ini:o.cards.pemasukan_sukarela_tahun_ini},k.value=[{name:"Pemasukan",data:o.chart.pemasukan},{name:"Pengeluaran",data:o.chart.pengeluaran}],P.value=o.chart.pemasukan[a]||0,f.value=L.data,p.value=O.data.data}catch(t){console.error("Error fetching data:",t),m.value="Gagal mengambil data dashboard.",c.isAxiosError(t)&&((r=t.response)==null?void 0:r.status)===401&&localStorage.removeItem("token"),F.push("/signin")}finally{_.value=!1}};return $(()=>{R()}),(r,t)=>{const l=Y("router-link");return d(),K(q,null,{default:S(()=>[e("div",Q,[t[14]||(t[14]=e("div",{class:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},null,-1)),m.value?(d(),u("div",X,s(m.value),1)):I("",!0),e("div",Z,[e("div",ee,[t[0]||(t[0]=e("div",{class:"flex flex-col gap-5 mb-6 sm:flex-row sm:justify-between"},[e("div",{class:"w-full"},[e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"},"Statistik Arus Kas"),e("p",{class:"mt-1 text-gray-500 text-theme-sm dark:text-gray-400"},"Grafik Pemasukan & Pengeluaran Tahun Ini ")])],-1)),e("div",te,[e("div",ae,[h(b(T),{type:"area",height:"310",options:E.value,series:k.value},null,8,["options","series"])])])]),e("div",se,[e("div",re,[t[1]||(t[1]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"},"Kepatuhan Warga (Bulan Ini)",-1)),e("p",ne," Total Warga: "+s(n.value.total_warga)+" Orang ",1)]),e("div",oe,[e("div",le,[h(b(T),{type:"radialBar",height:"330",options:M.value,series:w.value},null,8,["options","series"])])]),e("p",ie,[e("span",de,s(v.value),1),t[2]||(t[2]=y(" warga telah membayar. Tersisa ")),e("span",ue,s(n.value.warga_menunggak),1),t[3]||(t[3]=y(" warga yang belum lunas. "))]),e("div",ge,[e("div",me,[t[4]||(t[4]=e("p",{class:"mb-1 text-blue-600 dark:text-blue-400 text-xs font-medium"},"Total Kas Wajib (Tahun Ini)",-1)),e("p",ce,s(x(n.value.pemasukan_wajib_tahun_ini)),1)]),e("div",pe,[t[5]||(t[5]=e("p",{class:"mb-1 text-green-600 dark:text-green-400 text-xs font-medium"},"Total Sukarela (Tahun Ini)",-1)),e("p",xe,s(x(n.value.pemasukan_sukarela_tahun_ini)),1)])])]),e("div",he,[e("div",be,[t[8]||(t[8]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90 mb-4"},"Status Pembayaran",-1)),e("div",ye,[e("div",_e,[e("div",{class:"bg-blue-600 h-2.5 rounded-full",style:V({width:w.value[0]+"%"})},null,4)]),e("div",fe,[t[6]||(t[6]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-2 h-2 rounded-full bg-green-500"}),e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Sudah Bayar")],-1)),e("span",ke,s(v.value)+" Orang",1)]),e("div",ve,[t[7]||(t[7]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-2 h-2 rounded-full bg-red-500"}),e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Menunggak")],-1)),e("span",we,s(n.value.warga_menunggak)+" Orang",1)])])]),e("div",Be,[e("div",Ce,[t[10]||(t[10]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"},"Daftar Menunggak (Bulan Ini)",-1)),h(l,{to:"/laporan-kas",class:"text-xs text-blue-600 hover:underline"},{default:S(()=>t[9]||(t[9]=[y("Lihat Semua")])),_:1})]),e("div",Se,[p.value.length===0?(d(),u("div",Ie," Semua warga sudah bayar ✨ ")):I("",!0),(d(!0),u(j,null,D(p.value,(a,g)=>(d(),u("div",{key:g,class:"flex items-center justify-between p-3 border border-gray-50 dark:border-gray-800 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800/50 transition"},[e("div",De,[e("div",je,s(a.username.charAt(0).toUpperCase()),1),e("div",Te,[e("p",Ae,s(a.username),1),e("p",ze,s(a.phone||"No Phone"),1)])]),G(e("button",{onClick:B=>N(a),class:"p-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors shrink-0",title:"Kirim Pengingat WA"},t[11]||(t[11]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.246 2.248 3.484 5.232 3.484 8.412-.003 6.557-5.338 11.892-11.893 11.892-1.997-.001-3.951-.5-5.688-1.448l-6.309 1.656zm6.29-4.464c1.56.925 3.278 1.411 5.037 1.413 5.564 0 10.091-4.527 10.093-10.093 0-2.696-1.05-5.231-2.956-7.138-1.907-1.907-4.442-2.956-7.137-2.956-5.566 0-10.093 4.527-10.093 10.094 0 1.896.536 3.717 1.548 5.301l-.95 3.468 3.558-.934zm11.333-7.391c-.302-.151-1.785-.881-2.062-.982-.277-.1-.478-.151-.68.151-.202.302-.782.982-.957 1.183-.176.202-.352.226-.654.076-.302-.151-1.274-.47-2.426-1.5-.897-.8-1.502-1.79-1.678-2.091-.176-.302-.019-.465.131-.614.136-.134.302-.352.453-.528.151-.176.202-.302.302-.503.1-.202.05-.377-.025-.528-.076-.151-.68-1.641-.932-2.244-.247-.587-.499-.508-.68-.517-.176-.008-.377-.01-.579-.01-.202 0-.528.076-.805.377-.277.302-1.057 1.031-1.057 2.515 0 1.485 1.082 2.92 1.232 3.121.151.202 2.13 3.253 5.159 4.561.72.311 1.282.496 1.719.635.722.23 1.38.197 1.9.12.58-.086 1.785-.73 2.037-1.435.252-.704.252-1.308.176-1.435-.076-.127-.277-.202-.579-.353z"})],-1)]),8,Fe),[[U,b(z)=="admin"]])]))),128))])])]),e("div",Pe,[t[13]||(t[13]=e("div",{class:"flex items-center justify-between mb-4"},[e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"},"Aktivitas Terbaru")],-1)),e("div",Ee,[e("table",Me,[t[12]||(t[12]=e("thead",null,[e("tr",{class:"border-b border-gray-100 dark:border-gray-800"},[e("th",{class:"py-3 text-left font-medium text-gray-500 text-sm"},"Keterangan"),e("th",{class:"py-3 text-left font-medium text-gray-500 text-sm"},"Tipe"),e("th",{class:"py-3 text-left font-medium text-gray-500 text-sm"},"Nominal"),e("th",{class:"py-3 text-left font-medium text-gray-500 text-sm"},"Tanggal")])],-1)),e("tbody",null,[(d(!0),u(j,null,D(f.value,(a,g)=>(d(),u("tr",{key:g,class:"border-b border-gray-50 dark:border-gray-800 last:border-none hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors"},[e("td",Ne,[e("div",Re,[e("div",{class:A(["h-10 w-10 rounded-full flex items-center justify-center flex-shrink-0",a.type==="masuk"?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},[a.type==="masuk"?(d(),u("span",Le,"↓")):(d(),u("span",Oe,"↑"))],2),e("span",We,s(a.description),1)])]),e("td",$e,[e("span",{class:A(["text-xs font-medium px-3 py-1.5 rounded-full inline-block",a.type==="masuk"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"])},s(a.type==="masuk"?"Pemasukan":"Pengeluaran"),3)]),e("td",Ke,s(x(a.amount)),1),e("td",Ve,s(new Date(a.date).toLocaleDateString("id-ID")),1)]))),128))])])])])])]),t[15]||(t[15]=e("a",{href:"https://wa.me/6281294233137",target:"_blank",class:"fixed bottom-6 right-6 z-[9999] group flex items-center"},[e("span",{class:"mr-3 px-4 py-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 text-sm font-semibold rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-x-2 group-hover:translate-x-0 pointer-events-none"}," Chat Admin RT "),e("div",{class:"flex items-center justify-center w-10 h-10 bg-[#25D366] hover:bg-[#20ba5a] text-white rounded-2xl shadow-[0_8px_30px_rgb(37,211,102,0.4)] transition-all duration-300 hover:scale-105 active:scale-95"},[e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.246 2.248 3.484 5.232 3.484 8.412-.003 6.557-5.338 11.892-11.893 11.892-1.997-.001-3.951-.5-5.688-1.448l-6.309 1.656zm6.29-4.464c1.56.925 3.278 1.411 5.037 1.413 5.564 0 10.091-4.527 10.093-10.093 0-2.696-1.05-5.231-2.956-7.138-1.907-1.907-4.442-2.956-7.137-2.956-5.566 0-10.093 4.527-10.093 10.094 0 1.896.536 3.717 1.548 5.301l-.95 3.468 3.558-.934zm11.333-7.391c-.302-.151-1.785-.881-2.062-.982-.277-.1-.478-.151-.68.151-.202.302-.782.982-.957 1.183-.176.202-.352.226-.654.076-.302-.151-1.274-.47-2.426-1.5-.897-.8-1.502-1.79-1.678-2.091-.176-.302-.019-.465.131-.614.136-.134.302-.352.453-.528.151-.176.202-.302.302-.503.1-.202.05-.377-.025-.528-.076-.151-.68-1.641-.932-2.244-.247-.587-.499-.508-.68-.517-.176-.008-.377-.01-.579-.01-.202 0-.528.076-.805.377-.277.302-1.057 1.031-1.057 2.515 0 1.485 1.082 2.92 1.232 3.121.151.202 2.13 3.253 5.159 4.561.72.311 1.282.496 1.719.635.722.23 1.38.197 1.9.12.58-.086 1.785-.73 2.037-1.435.252-.704.252-1.308.176-1.435-.076-.127-.277-.202-.579-.353z"})])])],-1))]),_:1})}}}),Xe=H(Je,[["__scopeId","data-v-3769780f"]]);export{Xe as default};
